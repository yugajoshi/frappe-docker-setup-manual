# Frappe Docker Setup

## Option 1: Development Setup

```bash
git clone https://github.com/yugajoshi/frappe_docker.git
cd frappe-docker
docker compose â€“f pwd.yml up
Option 2: Production Setup
Option 2.1: With Containerized Mariadb and Letsencrypt SSL Certificates.
bash
Copy code
git clone https://github.com/yugajoshi/frappe_docker.git
cd frappe-docker
cp example.env .env
Store the YAML files
YAML files generated by docker compose config command can be stored in a directory.
We will create a directory called gitops in the user's home.

bash
Copy code
mkdir ~/gitops
Setup Frappe using containerized MariaDB and Redis with Letsencrypt certificates
In this case make sure you've set LETSENCRYPT_EMAIL and SITES environment variables or certificates won't work.

Generate YAML
bash
Copy code
docker compose -f compose.yaml \
  -f overrides/compose.mariadb.yaml \
  -f overrides/compose.redis.yaml \
  -f overrides/compose.https.yaml \
  config > ~/gitops/docker-compose.yml
Start containers
bash
Copy code
docker compose --project-name <project-name> -f ~/gitops/docker-compose.yml up -d
ðŸ‘‰ If external MariaDB is used, then donâ€™t use compose.mariadb.yaml in above command and make sure to mention DB_HOST in .env file.

Important Notes
In this whole setup, most important containers are Backend and Database.

To successfully get the certificates from Letsencrypt, add your site names in your DNS manager before running docker-compose file.
If sites are added in DNS manager after creating containers then just restart the Traefik container.
This happens because Letsencrypt assigns certificates only to those sites which are propagated on DNS Servers.

Few Things to Consider
Environment Variables

The .env file contains variables for ERPNext version, DB Host, sites, etc.

If the same variables are used, then it will pull Frappe and ERPNext applications only.

This is the easiest way where you can change the ERPNEXT_VERSION as per your choice.

Later you can use normal bench commands to get different apps of your choice.

Recommended way: Setup bench with Frappe and ERPNext apps and later pull required apps.

Multiple Sites

You can mention multiple sites in .env file in SITES variable.

For multitenancy to work, Traefik container is used which acts like a load balancer.

Traefik is used to route traffic to requested domain names and it also ensures applying SSL to sites.

Traefik will be configured for all the sites mentioned in .env file.

Later, if you create a new site in backend container, that site will not be accessible directly because Traefik is not aware of it.
To make this site work:

Modify docker-compose file and mention your new site name in this file.

Apply the modified compose file.

Restart the Traefik Container.

Site name should be enclosed in backticks and comma separated.

Using Letsencrypt for HTTPS

Mention your email id in .env file.

If you have your own certificates, then modify overrides/compose.https.yaml.

Remove lines related to Letsencrypt, store your certificates on VM and mount volumes where your certificates are stored.

(More on this in later section).

Using External MariaDB

If you want to use external MariaDB (like MariaDB hosted on different VM or MariaDB on AWS RDS), then use DB_HOST variable in .env file.

If different VM is being used for MariaDB, then mention Private IP of VM in DB_HOST variable and make sure to host your VM in private subnet to make it more secure.

If AWS RDS is being used, then mention DB Endpoint from Cloud Console.

Using Additional Apps

If you want additional apps like India Compliance, Frappe HRMS or your custom app along with Frappe and ERPNext then you first have to build the image with your required apps.

To build the image which will have apps of your choice, follow the steps available at:
ðŸ‘‰ Custom Apps Documentation

Once the image is pushed to any container registry like GHRC, DockerHub etc, you can use this image by adding environment variables CUSTOM_IMAGE, CUSTOM_TAG in .env file.
